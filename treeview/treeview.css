:root, .light-theme {
	--col-text: rgb(0, 0, 0);
	--col-text-hint: rgba(0, 0, 0, 0.2);
	--col-text-tags: rgba(0, 0, 0, 0.9);
	--col-text-missing-value: rgba(0, 0, 0, 0.5);
	--col-text-drag-drop: rgb(220, 220, 220);
	--col-text-filter-active: rgb(209, 136, 0);
	--col-text-filter-adjacent: rgb(0, 135, 224);

	--col-text-attr-key: rgb(196, 117, 0);
	--col-text-attr-value: rgb(128, 128, 128);

	--col-border-node-items: rgba(128, 128, 128, 0.1);
	--col-border-attr: rgba(128, 128, 128, 0.1);
	--col-border-attr-keyvalue: rgba(128, 128, 128, 0);
	--col-border-tags: rgba(128, 128, 128, 0.3);

	--col-bg-page: rgb(229, 229, 229);
	
	--col-bg-noscript: rgba(255, 0, 0, 0.25);

	--col-bg-filter: rgb(248, 248, 248);
	--col-bg-settings: rgba(248, 248, 248, 0.95);
	--col-bg-settings-header: rgb(252, 252, 252);
	
	--col-bg-node: rgb(248, 248, 248);
	--col-bg-attr: rgb(240, 240, 240);
	--col-bg-tags: rgba(0, 0, 0, 0.05);

	--col-bg-drag-drop: rgb(0, 0, 0, 0.7);
	
	--col-scroll-settings: rgb(230, 230, 230);
	
	--col-shadow-node: rgba(0, 0, 0, 0.10);
	--col-shadow-attr: rgba(0, 0, 0, 0.1);
	--col-shadow-settings: rgba(0, 0, 0, 0.25);

	--col-line-node-connect: rgb(192, 192, 192);
}

@media (prefers-color-scheme: dark) {
	:root {
		--col-text: rgb(220, 220, 220);
		--col-text-hint: rgba(220, 220, 220, 0.2);
		--col-text-tags: rgba(220, 220, 220, 0.9);
		--col-text-missing-value: rgba(220, 220, 220, 0.5);
		--col-text-drag-drop: rgb(220, 220, 220);
		--col-text-filter-active: rgb(219, 143, 0);
		--col-text-filter-adjacent: rgb(0, 135, 224);

		--col-text-attr-key: rgb(200, 150, 75);
		--col-text-attr-value: rgb(170, 170, 170);

		--col-border-node-items: rgba(128, 128, 128, 0.2);
		--col-border-attr: rgba(128, 128, 128, 0.25);
		--col-border-attr-keyvalue: rgba(128, 128, 128, 0);
		--col-border-tags: rgba(128, 128, 128, 0.5);

		--col-bg-page: rgb(24, 24, 24);

		--col-bg-noscript: rgba(255, 0, 0, 0.5);

		--col-bg-filter: rgb(48, 48, 48);
		--col-bg-settings: rgba(48, 48, 48, 0.95);
		--col-bg-settings-header: rgb(56, 56, 56);
		
		--col-bg-node: rgb(48, 48, 48);
		--col-bg-attr: rgb(40, 40, 40);
		--col-bg-tags: rgba(0, 0, 0, 0.15);

		--col-bg-drag-drop: rgb(0, 0, 0, 0.5);
		
		--col-scroll-settings: rgb(64, 64, 64);
		
		--col-shadow-node: rgba(0, 0, 0, 0.25);
		--col-shadow-attr: rgba(0, 0, 0, 0.15);
		--col-shadow-settings: rgba(0, 0, 0, 0.25);

		--col-line-node-connect: rgb(64, 64, 64);
	}
}

.dark-theme {
	--col-text: rgb(220, 220, 220);
	--col-text-hint: rgba(220, 220, 220, 0.2);
	--col-text-tags: rgba(220, 220, 220, 0.9);
	--col-text-missing-value: rgba(220, 220, 220, 0.5);
	--col-text-drag-drop: rgb(220, 220, 220);
	--col-text-filter-active: rgb(219, 143, 0);
	--col-text-filter-adjacent: rgb(0, 135, 224);

	--col-text-attr-key: rgb(200, 150, 75);
	--col-text-attr-value: rgb(170, 170, 170);

	--col-border-node-items: rgba(128, 128, 128, 0.2);
	--col-border-attr: rgba(128, 128, 128, 0.25);
	--col-border-attr-keyvalue: rgba(128, 128, 128, 0);
	--col-border-tags: rgba(128, 128, 128, 0.5);

	--col-bg-page: rgb(24, 24, 24);

	--col-bg-noscript: rgba(255, 0, 0, 0.5);

	--col-bg-filter: rgb(48, 48, 48);
	--col-bg-settings: rgba(48, 48, 48, 0.95);
	--col-bg-settings-header: rgb(56, 56, 56);
	
	--col-bg-node: rgb(48, 48, 48);
	--col-bg-attr: rgb(40, 40, 40);
	--col-bg-tags: rgba(0, 0, 0, 0.15);

	--col-bg-drag-drop: rgb(0, 0, 0, 0.5);
	
	--col-scroll-settings: rgb(64, 64, 64);
	
	--col-shadow-node: rgba(0, 0, 0, 0.25);
	--col-shadow-attr: rgba(0, 0, 0, 0.15);
	--col-shadow-settings: rgba(0, 0, 0, 0.25);

	--col-line-node-connect: rgb(64, 64, 64);
}


/* ----- Setup ----- */

* {
	box-sizing: border-box;
}

html, body {
	margin: 0;
	padding: 0;
}

body {
	font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
	width: auto;
	color: var(--col-text);
	background-color: var(--col-bg-page);
}

.icon-button {
	aspect-ratio: 1;
	border: none;
	background-color: transparent;
	opacity: 0.5;
	color: var(--col-text);
	padding: 0;
}

.icon-button:hover {
	opacity: 1;
}

/* ----- NoScript Message ----- */

#noscript {
	padding: 1em 2em;
	background-color: var(--col-bg-noscript);
	text-align: center;

	border-radius: 1em;
}

/* ----- Drag and drop overlay ----- */

#drag-overlay {
	position: fixed;
	inset: 0;

	z-index: 20;

	font-size: 2rem;

	gap: 1em;

	display: flex;
	flex-flow: row nowrap;
	justify-content: center;
	align-items: center;
	
	color: var(--col-text-drag-drop);
	background-color: var(--col-bg-drag-drop);
}

body:not(.drag) > #drag-overlay {
	display: none;
}

#drag-overlay .material-icons {
	font-size: 3rem;
}

#drag-overlay div {
	display: flex;
	flex-flow: column nowrap;
	gap: 0.5em;
}

#drag-overlay #drop-information {
	font-size: 0.75em;
}

/* ----- Settings Menu ----- */

#settings-panel,
#settings-show {
	position: fixed;
	top: 0;
	left: 0;
	margin: 1rem;
}

#settings-panel {
	max-width: 40ch;
	max-height: calc(100vh - 1rem * 2);
	z-index: 10;
	
	display: flex;
	flex-flow: column nowrap;
	overflow: hidden;

	border-radius: 0.5em;
	box-shadow: 2px 2px 12px 0 var(--col-shadow-settings);

	transform: translateX(calc(-100% - 2rem));
	transition: transform 250ms cubic-bezier(.17,.84,.44,1);
}

#settings-wrapper {
	overflow: hidden auto;
	
	font-size: 0.8rem;
	
	scrollbar-width: thin;
	scrollbar-color: var(--col-scroll-settings) var(--col-bg-settings);

	background-color: var(--col-bg-settings);
}

#settings.show #settings-panel {
	transform: translateX(0);
}

#settings-container {
	display: flex;
	flex-flow: column nowrap;
	align-items: stretch;

	padding-top: 1em;
}

#settings-container > * {
	padding: 0.5em 1em;
}

#settings-container > :last-child {
	padding-bottom: 1em;
}

#settings-title {
	position: sticky;
	top: 0;

	background-color: var(--col-bg-settings-header);

	font-size: large;
	font-weight: 600;
	display: flex;
	
	/* margin-bottom: 0.5em; */
	padding: 0.5em 0.75em;

	box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

#settings-title span {
	margin-inline: auto;
}

#settings-show {
	z-index: 5;
	opacity: 1;
	transition: opacity 150ms ease-in-out;
}

#settings.show #settings-show {
	opacity: 0;
}

label:hover > .icon-button {
	opacity: 1;
}

#active-file-type {
	margin-left: auto;

	font-family: 'Courier New', Courier, monospace;

	font-size: 0.75rem;
}

label {
	display: flex;
	align-items: center;
	gap: 0.75em;
}

.custom-checkbox > .icon-button {
	font-size: 1.25rem;
}

.custom-checkbox > input[type="checkbox"] {
	display: none;
}

.custom-checkbox > input[type="checkbox"] + .icon-button::before {
	content: "check_box_outline_blank";
}

.custom-checkbox > input[type="checkbox"]:checked + .icon-button::before {
	content: "check_box";
}

/* ----- Node Placeholder Text ----- */

.node-placeholder {
	text-align: center;
}

/* ----- Node Tree Structure ----- */

#container {
	margin-inline: auto;
	width: fit-content;
	padding: 2rem;
}

.node {
	display: flex;
	flex-flow: column nowrap;
	align-items: center;

	gap: 0rem;
}

.node.hidden {
	display: none;
}

.node-children {
	display: flex;
	flex-flow: row nowrap;
	justify-content: center;

	position: relative;
	padding-top: 4rem;

	gap: 2rem;
}

.node-head {
	margin: 0em 0.5em;
	background-color: var(--col-bg-node);

	display: flex;
	flex-flow: column nowrap;
	gap: 0.25em;

	border-radius: 0.5em;

	box-shadow: 2px 2px 16px 2px var(--col-shadow-node);
}

.node-head > * {
	padding: 0.25em 1em;
}

.node-head.no-attributes .attributes,
.node-head:not(.no-attributes) .no-attributes-label,
.node-head.no-value #value,
.node-head:not(.no-value) .no-value-label,
.node-head.no-tags #tags,
#container:not(.show-missing-attributes) .no-attributes-label,
#container:not(.show-missing-values) .no-value-label {
	display: none;
}

.node-head #title {
	padding-inline: 0.5em;

	display: flex;
	flex-flow: row nowrap;
	align-items: baseline;
	gap: 0.5em;
}

.node-head #title-type {
	font-size: 1.25rem;
	font-weight: 800;
	color: var(--col-text-hint);
	letter-spacing: 2px;
	user-select: none;

	line-height: 1;
}

.node-head > * + * {
	border-top: thin solid var(--col-border-node-items);
}

.node-head #title-name {
	font-family: 'Courier New', Courier, monospace;
	font-weight: 600;

	margin-right: 0.5em;
}

.no-attributes-label,
.no-value-label {
	font-size: 0.75rem;
	font-weight: 700;

	color: var(--col-text-missing-value);
}

/* ----- Attribute Table ----- */

.node-head > details {
	padding-inline: 0;
}

.node-head > details > * {
	padding: 0.25em 1em;
}

.node-head > details > summary {
	user-select: none;
	cursor: pointer;

	padding-left: 0.5em;

	display: flex;
	align-items: center;
}

.node-head > details > summary::before {
	content: "chevron_right";
	font-family: 'Material Icons';
	font-weight: normal;
	font-style: normal;
	font-size: 1.5em;
	line-height: 1;
	letter-spacing: normal;
	text-transform: none;
	display: inline-block;
	white-space: nowrap;
	word-wrap: normal;
	direction: ltr;
	-moz-font-feature-settings: 'liga';
	-moz-osx-font-smoothing: grayscale;

	rotate: 0deg;

	transition: rotate 100ms ease-in-out;
}

.node-head > details[open] > summary::before {
	rotate: 90deg;
}

.attribute-container {
	width: 100%;
	background-color: var(--col-bg-attr);	
	padding-block: 0.25em;

	box-shadow: 
		0 5px 5px -5px var(--col-shadow-attr) inset,
		0 -5px 5px -5px var(--col-shadow-attr) inset;
}

#attributes-table {
	border-collapse: collapse;
}

#attributes-table td {
	max-width: 20ch;
	line-break: anywhere;

	padding-block: 0.25em;
}

#attributes-table td:first-child {
	text-align: right;
	vertical-align: top;
	padding-right: 0.5em;

	border-right: thin solid var(--col-border-attr-keyvalue);

	color: var(--col-text-attr-key);
}

#attributes-table td:last-child {
	color: var(--col-text-attr-value);
	padding-left: 0.5em;
}

#attributes-table tr + tr > td {
	border-top: thin solid var(--col-border-attr);
}

/* ----- Tags ----- */

.node-head #tags {
	display: flex;
	flex-flow: row wrap;

	padding-inline: 0.25em;
}

#tags > span {
	display: inline-block;

	font-size: 0.75rem;
	padding: 0.2ch 1.2ch;
	margin: 0.2em;

	color: var(--col-text-tags);

	background-color: var(--col-bg-tags);
	border: thin solid var(--col-border-tags);

	border-radius: 2em;
}

/* ----- Values ----- */

#value {
	display: flex;

	align-items: flex-start;
	gap: 0.5em;

	padding-left: 0.5em;
}

.value-label {
	font-size: 0.8rem;
	padding-top: calc(1rem - 1em);
	font-weight: 700;

	color: var(--col-text-hint);
}

#value #value-type {
	display: none;
}

/* ----- Filter Options ----- */

#container:not(.node-settings) .dropdown {
	display: none;
}

.dropdown {
	position: relative;
	margin-left: auto;
}

.dropdown > #filter-button {
	font-size: 1.2rem;
}

.node.filter-active > .node-head #filter-button {
	color: var(--col-text-filter-active);
}

.node.filter-active > .node-children > .node:not(.filter-active) > .node-head #filter-button {
	color: var(--col-text-filter-adjacent);
}

.dropdown:not(.show) > div {
	display: none
}

.dropdown > div {
	position: absolute;
	top: 100%;
	right: 0;
	z-index: 5;

	display: flex;
	flex-flow: column nowrap;
	align-items: stretch;

	border-radius: 0.5em;

	overflow: hidden;

	width: max-content;

	background-color: var(--col-bg-filter);

	box-shadow: 1px 1px 8px 2px rgba(0, 0, 0, 0.2);
}

.dropdown > div > * {
	padding: 0.5em 1em;
}

.dropdown > div > button {
	background-color: transparent;
	border: none;

	color: var(--col-text);
}

.dropdown > div > button:hover {
	background-color: rgba(128, 128, 128, 0.2);
}

/* ----- Connecting Lines ----- */

.node-connection {
	stroke: var(--col-line-node-connect);
	stroke-width: 1.5;
	stroke-linecap: round;

	z-index: -2;
}
